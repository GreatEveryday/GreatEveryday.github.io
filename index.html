<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MBTI äººæ ¼æµ‹è¯•</title>
    <!-- å¼•å…¥ Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ä½¿ç”¨ Inter å­—ä½“ä½œä¸ºé»˜è®¤ï¼Œå¹¶å›é€€åˆ°ç³»ç»Ÿæ— è¡¬çº¿å­—ä½“ */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        }
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ï¼Œä½¿å…¶åœ¨ä¸åŒæµè§ˆå™¨ä¸Šçœ‹èµ·æ¥æ›´å¥½ */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #cbd5e1; /* slate-300 */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-track {
            background-color: #f1f5f9; /* slate-100 */
        }
        /* éšè—åŸç”Ÿ radio input ä½†ä¿æŒå¯ç‚¹å‡»åŒºåŸŸ */
        .radio-label input {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        .radio-tile {
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            user-select: none;
            border: 2px solid transparent;
        }
        /* é€‰ä¸­æ—¶çš„æ ·å¼ */
        .radio-label input:checked + .radio-tile {
            background-color: #3b82f6; /* blue-500 */
            color: white;
            border-color: #1d4ed8; /* blue-700 */
            transform: scale(1.05);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        /* è¿›åº¦æ¡æ ·å¼ */
        #progress-bar {
            height: 10px;
            background-color: #d1d5db; /* gray-300 */
            border-radius: 9999px;
            overflow: hidden;
        }
        #progress-indicator {
            height: 100%;
            background-color: #2563eb; /* blue-600 */
            transition: width 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col items-center p-4">

    <!-- ä¸»å®¹å™¨ -->
    <div id="main-container" class="w-full max-w-4xl bg-white shadow-2xl rounded-xl p-6 md:p-10 my-8">

        <h1 class="text-4xl font-extrabold text-gray-900 mb-2 text-center">MBTI äººæ ¼å€¾å‘æ€§æµ‹è¯•</h1>
        <p class="text-lg text-gray-500 mb-8 text-center border-b pb-4">è¯·æ ¹æ®æ‚¨çš„çœŸå®æ„Ÿå—ï¼Œé€‰æ‹©æœ€ç¬¦åˆæ‚¨æƒ…å†µçš„é€‰é¡¹ (å…± 50 é¢˜)</p>

        <!-- 1. å¼€å§‹ç•Œé¢ -->
        <div id="start-screen" class="text-center py-20">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-blue-500 mx-auto mb-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
            <h2 class="text-3xl font-bold text-gray-800 mb-4">å‡†å¤‡å¥½äº†è§£çœŸå®çš„è‡ªå·±äº†å—ï¼Ÿ</h2>
            <p class="text-gray-600 mb-8">æœ¬æµ‹è¯•åŒ…å« 50 é“é—®é¢˜ï¼Œæ—¨åœ¨å¸®åŠ©æ‚¨å‘ç°æ‚¨çš„äººæ ¼ç±»å‹å’Œåå¥½ç»´åº¦ã€‚</p>
            <button onclick="startTest()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-10 rounded-full transition duration-300 shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-300">
                å¼€å§‹æµ‹è¯•
            </button>
        </div>

        <!-- 2. æµ‹è¯•å†…å®¹åŒºåŸŸ (é»˜è®¤éšè—) -->
        <div id="test-content" class="hidden">
            <!-- è¿›åº¦æ¡ -->
            <div id="progress-bar" class="mb-8">
                <div id="progress-indicator" style="width: 0%;"></div>
            </div>

            <!-- å•ä¸ªé—®é¢˜æ¸²æŸ“åŒºåŸŸ -->
            <div id="question-container" class="space-y-8">
                <!-- å•ä¸ªé—®é¢˜å°†ç”± JavaScript æ¸²æŸ“åˆ°è¿™é‡Œ -->
            </div>

            <!-- å¯¼èˆªæŒ‰é’® -->
            <div class="mt-10">
                <div class="flex items-center space-x-4">
                    <button id="prev-button" onclick="previousQuestion()" class="flex-shrink-0 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-6 rounded-full transition duration-300 shadow-lg focus:outline-none focus:ring-4 focus:ring-gray-300 hidden">
                        ä¸Šä¸€é¢˜
                    </button>
                    <button id="next-button" onclick="nextQuestion()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full transition duration-300 shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-300">
                        ä¸‹ä¸€é¢˜
                    </button>
                </div>
                <p id="error-message" class="text-red-600 text-center font-medium mt-4 hidden"></p>
            </div>
        </div>
    </div>

    <!-- ç»“æœä»˜è´¹å¢™/è¦†ç›–å±‚ -->
    <div id="payment-overlay" class="fixed inset-0 bg-gray-900 bg-opacity-80 backdrop-blur-sm z-50 items-center justify-center hidden">
        <div class="bg-white rounded-xl shadow-2xl p-8 max-w-lg w-11/12 transform transition-all duration-300 scale-100">
            <div class="text-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-yellow-500 mx-auto mb-4" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1h2a2 2 0 012 2v2h1a1 1 0 010 2h-1v2h1a1 1 0 010 2h-1v1a2 2 0 01-2 2h-2v1a1 1 0 11-2 0v-1H7a2 2 0 01-2-2v-1h1a1 1 0 010-2H5v-2h1a1 1 0 010-2H5V6a2 2 0 012-2h2V3a1 1 0 011-1zM7 6h6v4H7V6zm6 6H7v2h6v-2z" clip-rule="evenodd" />
                </svg>
                <h2 class="text-3xl font-bold text-gray-900 mb-3">æ­å–œæ‚¨ï¼Œæµ‹è¯•å®Œæˆï¼</h2>
                <p class="text-gray-600 mb-6">æ‚¨çš„ä¸“å± MBTI äººæ ¼åˆ†ææŠ¥å‘Šå·²ç”Ÿæˆï¼Œä½†å°šæœªè§£é”ã€‚</p>
                <p class="text-2xl font-extrabold text-blue-600 mb-6">Â¥ 9.90 è§£é”å®Œæ•´æŠ¥å‘Š</p>
            </div>

            <button onclick="simulatePayment()" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg transition duration-300 shadow-md hover:shadow-lg focus:outline-none focus:ring-4 focus:ring-green-300">
                ç«‹å³å……å€¼ 9.90 å…ƒè§£é”
            </button>

            <p class="text-xs text-gray-400 mt-4">ï¼ˆæœ¬é¡µé¢ä»…ä¸ºåŠŸèƒ½æ¼”ç¤ºï¼Œç‚¹å‡»æŒ‰é’®å°†ç›´æ¥æ¨¡æ‹Ÿâ€œæ”¯ä»˜æˆåŠŸâ€å¹¶æ˜¾ç¤ºç»“æœï¼‰</p>
        </div>
    </div>

    <!-- ç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
    <div id="result-display" class="w-full max-w-4xl bg-white shadow-2xl rounded-xl p-6 md:p-10 my-8 hidden">
        <h2 class="text-4xl font-extrabold text-center text-blue-600 mb-6">ğŸ‰ æ‚¨çš„ MBTI æŠ¥å‘Šå·²è§£é”ï¼</h2>
        <div class="bg-blue-50 border-l-4 border-blue-400 p-6 rounded-lg mb-8">
            <h3 class="text-xl font-semibold text-blue-800 mb-2">äººæ ¼ç±»å‹ï¼š</h3>
            <p id="mbti-type" class="text-6xl font-black text-blue-900 tracking-wider">----</p>
        </div>

        <h3 class="text-2xl font-bold text-gray-800 mb-4">ç±»å‹æè¿°ï¼š</h3>
        <p id="mbti-description" class="text-gray-700 leading-relaxed text-lg whitespace-pre-line">
            <!-- æè¿°å°†ç”± JavaScript å¡«å…… -->
        </p>

        <div class="mt-10 pt-6 border-t border-gray-200">
            <h3 class="text-xl font-semibold text-gray-800 mb-3">ç»´åº¦åˆ†æï¼š</h3>
            <div id="dimension-analysis" class="space-y-4">
                <!-- ç»´åº¦åˆ†æå°†ç”± JavaScript å¡«å…… -->
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€çŠ¶æ€å˜é‡
        let currentQuestionIndex = 0;
        const userAnswers = {}; // å­˜å‚¨ç”¨æˆ·ç­”æ¡ˆ: { qId: score }

        // MBTI 16 ç§äººæ ¼ç±»å‹çš„æè¿° (ä»…åˆ—ä¸¾éƒ¨åˆ†ä½œä¸ºç¤ºä¾‹)
        const MBTI_RESULTS = {
            'ESTJ': { name: 'ç›‘ç£è€…', description: 'åŠ¡å®ã€æœ‰æ¡ç†ã€æ³¨é‡æ•ˆç‡å’Œè§„åˆ™ã€‚æ˜¯å¤©ç”Ÿçš„ç»„ç»‡è€…å’Œæ‰§è¡Œè€…ã€‚' },
            'ESTP': { name: 'åˆ›ä¸šè€…', description: 'ç²¾åŠ›å……æ²›ã€æ´»æ³¼ï¼Œå–œæ¬¢ç«‹å³è¡ŒåŠ¨ï¼Œäº«å—å½“ä¸‹å’Œç‰©è´¨ç”Ÿæ´»ã€‚' },
            'ESFJ': { name: 'æ‰§æ”¿å®˜', description: 'çƒ­å¿ƒã€åˆç¾¤ã€è´Ÿè´£ä»»ï¼Œæ³¨é‡å’Œè°å’Œäººé™…å…³ç³»ï¼Œæ˜¯å›¢é˜Ÿçš„ç²˜åˆå‰‚ã€‚' },
            'ESFP': { name: 'è¡¨æ¼”è€…', description: 'å¤–å‘ã€ä¹è§‚ã€çƒ­çˆ±ç”Ÿæ´»å’Œä½“éªŒæ–°äº‹ç‰©ï¼Œå–œæ¬¢æˆä¸ºèšå…‰ç¯çš„ç„¦ç‚¹ã€‚' },
            'ENTJ': { name: 'æŒ‡æŒ¥å®˜', description: 'æœæ–­ã€æœ‰è¿œè§ã€æˆ˜ç•¥æ€§å¼ºï¼Œå¤©ç”Ÿå…·å¤‡é¢†å¯¼æ‰èƒ½ï¼Œæ“…é•¿åˆ¶å®šå¹¶å®æ–½é•¿æœŸè®¡åˆ’ã€‚' },
            'ENTP': { name: 'è¾©è®ºå®¶', description: 'æœºæ™ºã€å¯Œæœ‰åˆ›é€ åŠ›ã€å–œæ¬¢æŒ‘æˆ˜ç°çŠ¶ï¼Œäº«å—æ€æƒ³çš„äº¤é”‹ä¸æ¢ç´¢ã€‚' },
            'ENFJ': { name: 'ä¸»äººå…¬', description: 'é­…åŠ›éå‡¡ã€å¯Œæœ‰æ„ŸæŸ“åŠ›ã€ç†æƒ³ä¸»ä¹‰è€…ï¼Œæ“…é•¿æ¿€å‘ä»–äººçš„æ½œèƒ½ã€‚' },
            'ENFP': { name: 'ç«é€‰è€…', description: 'çƒ­æƒ…æ´‹æº¢ã€å……æ»¡å¥½å¥‡å¿ƒã€å¯Œæœ‰æƒ³è±¡åŠ›ï¼Œæ€»æ˜¯èƒ½æ‰¾åˆ°ç”Ÿæ´»çš„ä¹è¶£ã€‚' },
            'ISTJ': { name: 'ç‰©æµå¸ˆ', description: 'å®‰é™ã€è®¤çœŸã€å°½è´£ï¼Œæ³¨é‡äº‹å®å’Œç»†èŠ‚ï¼Œæ˜¯å¯é çš„åŸºçŸ³ã€‚' },
            'ISTP': { name: 'é‰´èµå®¶', description: 'å†·é™ã€å®é™…ã€è§‚å¯ŸåŠ›å¼ºï¼Œå–œæ¬¢åŠ¨æ‰‹æ“ä½œå’Œè§£å†³å®é™…é—®é¢˜ã€‚' },
            'ISFJ': { name: 'ä¿æŠ¤è€…', description: 'ä½“è´´ã€å¿ è¯šã€ä¼ ç»Ÿï¼Œä¹äºå¥‰çŒ®ï¼Œé»˜é»˜åœ°æ”¯æŒå’Œä¿æŠ¤èº«è¾¹çš„äººã€‚' },
            'ISFP': { name: 'æ¢é™©å®¶', description: 'æ¸©æŸ”ã€æ•æ„Ÿã€å–œæ¬¢è‡ªç”±å’Œè‰ºæœ¯ï¼Œé€šè¿‡è¡ŒåŠ¨å’Œåˆ›é€ æ¥è¡¨è¾¾è‡ªæˆ‘ã€‚' },
            'INTJ': { name: 'å»ºç­‘å¸ˆ', description: 'ç‹¬ç«‹ã€åˆ›æ–°ã€é€»è¾‘ä¸¥è°¨ï¼Œæ“…é•¿ç‹¬ç«‹æ€è€ƒå’Œè®¾è®¡å¤æ‚çš„ç³»ç»Ÿã€‚' },
            'INTP': { name: 'é€»è¾‘å­¦å®¶', description: 'æ±‚çŸ¥æ¬²å¼ºã€å–œæ¬¢ç†è®ºã€åˆ†æèƒ½åŠ›çªå‡ºï¼Œæ²‰æµ¸åœ¨æ€æƒ³çš„æµ·æ´‹ä¸­ã€‚' },
            'INFJ': { name: 'æå€¡è€…', description: 'å®‰é™ã€ç¥ç§˜ã€ç†æƒ³ä¸»ä¹‰ï¼Œè‡´åŠ›äºå®ç°äººç±»çš„ç¦ç¥‰ã€‚' },
            'INFP': { name: 'è°ƒåœè€…', description: 'å–„è‰¯ã€å¯Œæœ‰åŒæƒ…å¿ƒã€è¿½æ±‚æ„ä¹‰å’Œä»·å€¼ï¼Œå†…å¿ƒä¸–ç•Œä¸°å¯Œã€‚' }
        };

        // 50ä¸ªæµ‹è¯•é—®é¢˜å®šä¹‰
        // category: E, S, T, J (é«˜åˆ†å€¾å‘äºè¯¥å­—æ¯)
        const QUESTIONS = [
            // E/I 12 Questions (Max Score: 12 * 4 = 48. Midpoint 24)
            { id: 1, text: "åœ¨èšä¼šä¸­ï¼Œæ‚¨é€šå¸¸æ˜¯ä¸»åŠ¨å’Œé™Œç”Ÿäººæ”€è°ˆçš„äººã€‚", category: 'E' },
            { id: 2, text: "æ‚¨æ›´å–œæ¬¢é€šè¿‡å†™ä½œæˆ–ç‹¬å¤„æ¥åæ€å’Œæ•´ç†æ€ç»ªã€‚", category: 'E', reverse: true }, // I å€¾å‘ï¼Œä½†ä¸ºäº†ç®€åŒ–è¯„åˆ†ï¼Œç»Ÿä¸€ä½¿ç”¨ E/S/T/J è®¡åˆ†ï¼Œç”¨ reverse æ ‡è®°
            { id: 3, text: "å½“æ‚¨æ„Ÿåˆ°ç–²å€¦æ—¶ï¼Œä¸ä»–äººäº¤æµä¼šè®©æ‚¨æ„Ÿè§‰å……æ»¡æ´»åŠ›ã€‚", category: 'E' },
            { id: 4, text: "æ‚¨è®¤ä¸ºè‡ªå·±æ˜¯ä¸€ä¸ªâ€œè¡ŒåŠ¨æ´¾â€è€Œä¸æ˜¯â€œæ€æƒ³å®¶â€ã€‚", category: 'E' },
            { id: 5, text: "æ‚¨ä¹ æƒ¯äºå°†ç§äººç”Ÿæ´»å’Œå·¥ä½œåˆ†å¼€ã€‚", category: 'E', reverse: true }, // I å€¾å‘
            { id: 6, text: "æ‚¨æœ‰å¾ˆå¤šç†Ÿäººï¼Œä½†åªæœ‰å°‘æ•°å‡ ä¸ªéå¸¸äº²å¯†çš„æœ‹å‹ã€‚", category: 'E', reverse: true }, // I å€¾å‘
            { id: 7, text: "æ‚¨æ›´å–œæ¬¢ä¸€ä¸ªç”±å¤šæ–¹è®¨è®ºå…±åŒä½œå‡ºçš„å†³å®šã€‚", category: 'E' },
            { id: 8, text: "æ‚¨ç»å¸¸åœ¨æ²¡æœ‰äº‹å…ˆå‡†å¤‡çš„æƒ…å†µä¸‹ç›´æ¥å‘è¨€æˆ–è¡ŒåŠ¨ã€‚", category: 'E' },
            { id: 9, text: "åœ¨å…¬å…±åœºåˆï¼Œæ‚¨é€šå¸¸ä¼šé¿å…å¼•èµ·åˆ«äººçš„æ³¨æ„ã€‚", category: 'E', reverse: true }, // I å€¾å‘
            { id: 10, text: "æ‚¨è®¤ä¸ºä¸ä»–äººäº¤æµæ¯”é˜…è¯»æ›´èƒ½å­¦åˆ°ä¸œè¥¿ã€‚", category: 'E' },
            { id: 11, text: "æ‚¨æ›´å€¾å‘äºåœ¨å®‰é™ã€ç‹¬ç«‹çš„åŠå…¬ç¯å¢ƒä¸­å·¥ä½œã€‚", category: 'E', reverse: true }, // I å€¾å‘
            { id: 12, text: "æ‚¨èƒ½è½»æ¾åœ°å‘åˆ«äººä»‹ç»æ‚¨è‡ªå·±ã€‚", category: 'E' },

            // S/N 13 Questions (Max Score: 13 * 4 = 52. Midpoint 26)
            { id: 13, text: "æ‚¨æ›´å…³æ³¨äº‹æƒ…çš„å®é™…ç”¨é€”è€Œä¸æ˜¯ç†è®ºä¸Šçš„å¯èƒ½æ€§ã€‚", category: 'S' },
            { id: 14, text: "æ‚¨å–œæ¬¢æ€è€ƒæŠ½è±¡çš„è§‚å¿µå’Œæœªæ¥çš„è¶‹åŠ¿ã€‚", category: 'S', reverse: true }, // N å€¾å‘
            { id: 15, text: "æ‚¨å¯¹ç»†èŠ‚çš„å…³æ³¨ç¨‹åº¦å¾ˆé«˜ï¼Œä¸å®¹æ˜“å¿½ç•¥å°é”™è¯¯ã€‚", category: 'S' },
            { id: 16, text: "æ‚¨ç›¸ä¿¡â€œå…­æ„Ÿâ€æˆ–ç›´è§‰èƒ½ç»™æ‚¨å¸¦æ¥æ­£ç¡®çš„ç­”æ¡ˆã€‚", category: 'S', reverse: true }, // N å€¾å‘
            { id: 17, text: "åœ¨è®²æ•…äº‹æ—¶ï¼Œæ‚¨å€¾å‘äºæŒ‰ç…§äº‹ä»¶å‘ç”Ÿçš„å‡†ç¡®é¡ºåºè¿›è¡Œã€‚", category: 'S' },
            { id: 18, text: "æ‚¨ç»å¸¸æ²‰æµ¸åœ¨è‡ªå·±çš„æƒ³è±¡å’Œç™½æ—¥æ¢¦ä¸­ã€‚", category: 'S', reverse: true }, // N å€¾å‘
            { id: 19, text: "æ‚¨æ›´å–œæ¬¢æ˜ç¡®çš„ã€å¯è¡¡é‡çš„ç»“æœï¼Œè€Œä¸æ˜¯å¼€æ”¾å¼çš„æ¢ç´¢ã€‚", category: 'S' },
            { id: 20, text: "æ‚¨è®¤ä¸ºâ€œå¯èƒ½æ€§â€æ¯”â€œç°å®â€æ›´æœ‰è¶£ã€‚", category: 'S', reverse: true }, // N å€¾å‘
            { id: 21, text: "æ‚¨åœ¨å·¥ä½œä¸­æ›´å–œæ¬¢ä½¿ç”¨ç»è¿‡éªŒè¯çš„æ–¹æ³•ã€‚", category: 'S' },
            { id: 22, text: "æ‚¨å–„äºå‘ç°äº‹ç‰©ä¹‹é—´çš„éšè—è”ç³»å’Œæ·±å±‚å«ä¹‰ã€‚", category: 'S', reverse: true }, // N å€¾å‘
            { id: 23, text: "å¯¹æ‚¨æ¥è¯´ï¼Œçœ¼è§ä¸ºå®ã€‚", category: 'S' },
            { id: 24, text: "æ‚¨è®¤ä¸ºå¤§å¤šæ•°è§„åˆ™éƒ½å¯ä»¥æœ‰ä¾‹å¤–ã€‚", category: 'S', reverse: true }, // N å€¾å‘
            { id: 25, text: "æ‚¨ç»å¸¸è¢«æè¿°ä¸ºä¸€ä¸ªè„šè¸å®åœ°çš„äººã€‚", category: 'S' },

            // T/F 13 Questions (Max Score: 13 * 4 = 52. Midpoint 26)
            { id: 26, text: "åœ¨åšå†³å®šæ—¶ï¼Œæ‚¨ä¸»è¦ä¾é é€»è¾‘åˆ†æå’Œå®¢è§‚äº‹å®ã€‚", category: 'T' },
            { id: 27, text: "æ‚¨å¾ˆå®¹æ˜“è¢«ä»–äººçš„æƒ…ç»ªæ‰€æ„ŸæŸ“ã€‚", category: 'T', reverse: true }, // F å€¾å‘
            { id: 28, text: "æ‚¨è®¤ä¸ºå…¬æ­£æ¯”åŒæƒ…å¿ƒæ›´é‡è¦ã€‚", category: 'T' },
            { id: 29, text: "æ‚¨ä¼šåŠªåŠ›é¿å…ä¼¤å®³ä»–äººçš„æ„Ÿå—ã€‚", category: 'T', reverse: true }, // F å€¾å‘
            { id: 30, text: "æ‚¨è®¤ä¸ºè¡¨è¾¾è‡ªå·±çš„æ„¤æ€’æˆ–æ²®ä¸§æ˜¯å¯ä»¥æ¥å—çš„ã€‚", category: 'T' },
            { id: 31, text: "æ‚¨åœ¨æ‰¹è¯„ä»–äººæ—¶ä¼šå°½é‡æªè¾æ¸©å’Œã€‚", category: 'T', reverse: true }, // F å€¾å‘
            { id: 32, text: "å½“æ‚¨éœ€è¦åšé€‰æ‹©æ—¶ï¼Œæ‚¨ä¼šåˆ—å‡ºåˆ©å¼Šæ¸…å•ã€‚", category: 'T' },
            { id: 33, text: "æ‚¨è®¤ä¸ºä¸€ä¸ªå¥½çš„é¢†å¯¼è€…åº”è¯¥é¦–å…ˆå…·å¤‡å…³æ€€ä»–äººçš„èƒ½åŠ›ã€‚", category: 'T', reverse: true }, // F å€¾å‘
            { id: 34, text: "æ‚¨æ›´å®¹æ˜“å¯¹ä¸æ‚¨æ— å…³çš„æ‚²æƒ¨äº‹ä»¶æ„Ÿåˆ°æ‚²ä¼¤ã€‚", category: 'T', reverse: true }, // F å€¾å‘
            { id: 35, text: "æ‚¨é€šå¸¸èƒ½ä¿æŒå†·é™ï¼Œä¸ä¼šè®©æƒ…ç»ªå½±å“æ‚¨çš„åˆ¤æ–­ã€‚", category: 'T' },
            { id: 36, text: "æ‚¨è®¤ä¸ºå¦ç‡ç›´è¨€æ¯”é¡¾åŠé¢å­æ›´é‡è¦ã€‚", category: 'T' },
            { id: 37, text: "æ‚¨ç»å¸¸å› ä¸ºä»–äººçš„é—®é¢˜è€Œæ„Ÿåˆ°å‹åŠ›æˆ–çƒ¦æ¼ã€‚", category: 'T', reverse: true }, // F å€¾å‘
            { id: 38, text: "åœ¨å†²çªä¸­ï¼Œæ‚¨æ›´å€¾å‘äºæ‰¾å‡ºè°æ˜¯æ­£ç¡®çš„ï¼Œè€Œä¸æ˜¯è®©åŒæ–¹éƒ½æ„Ÿåˆ°æ»¡æ„ã€‚", category: 'T' },

            // J/P 12 Questions (Max Score: 12 * 4 = 48. Midpoint 24)
            { id: 39, text: "æ‚¨å–œæ¬¢äº‹å…ˆåˆ¶å®šè®¡åˆ’ï¼Œå¹¶ä¸”å°½é‡æŒ‰ç…§è®¡åˆ’æ‰§è¡Œã€‚", category: 'J' },
            { id: 40, text: "æ‚¨æ›´å–œæ¬¢åœ¨æœ€åä¸€åˆ»åšå†³å®šï¼Œä»¥ä¿æŒçµæ´»æ€§ã€‚", category: 'J', reverse: true }, // P å€¾å‘
            { id: 41, text: "æ‚¨å¯¹æœªå®Œæˆçš„ä»»åŠ¡æ„Ÿåˆ°ä¸é€‚ã€‚", category: 'J' },
            { id: 42, text: "æ‚¨å¾ˆå®¹æ˜“è¢«çªå‘å¥‡æƒ³å¸å¼•ï¼Œå³ä½¿è¿™æ‰“ä¹±äº†æ‚¨çš„æ—¥ç¨‹ã€‚", category: 'J', reverse: true }, // P å€¾å‘
            { id: 43, text: "æ‚¨åœ¨æ•´ç†è‡ªå·±çš„ç©ºé—´å’Œæ–‡ä»¶æ–¹é¢éå¸¸æœ‰æ•ˆç‡ã€‚", category: 'J' },
            { id: 44, text: "æ‚¨è®¤ä¸ºè§„åˆ™å’Œæˆªæ­¢æ—¥æœŸæ˜¯çµæ´»çš„ã€‚", category: 'J', reverse: true }, // P å€¾å‘
            { id: 45, text: "æ‚¨å€¾å‘äºå°½å¿«å®Œæˆä»»åŠ¡ï¼Œè€Œä¸æ˜¯æ‹–åˆ°æœ€åä¸€åˆ»ã€‚", category: 'J' },
            { id: 46, text: "æ‚¨æ›´å–œæ¬¢è‡ªç”±å’Œè‡ªå‘æ€§ï¼Œè€Œä¸æ˜¯ç»“æ„å’Œç»„ç»‡ã€‚", category: 'J', reverse: true }, // P å€¾å‘
            { id: 47, text: "æ‚¨ç»å¸¸æå‰å¾ˆä¹…ä¸ºåº¦å‡æ—…è¡Œåšè¯¦ç»†çš„å®‰æ’ã€‚", category: 'J' },
            { id: 48, text: "åœ¨æ—…è¡Œä¸­ï¼Œæ‚¨å–œæ¬¢è¾¹èµ°è¾¹çœ‹ï¼Œè€Œä¸æ˜¯æå‰é¢„å®šå¥½ä¸€åˆ‡ã€‚", category: 'J', reverse: true }, // P å€¾å‘
            { id: 49, text: "æ‚¨è®¤ä¸ºæœ‰æ˜ç¡®çš„è¿›åº¦è¡¨èƒ½è®©æ‚¨æ›´é«˜æ•ˆã€‚", category: 'J' },
            { id: 50, text: "æ‚¨å¾ˆå°‘åšå¾…åŠäº‹é¡¹æ¸…å•ï¼ˆTo-Do Listï¼‰ã€‚", category: 'J', reverse: true }, // P å€¾å‘
        ];

        /**
         * å¯åŠ¨æµ‹è¯•ï¼šéšè—å¼€å§‹ç•Œé¢ï¼Œæ˜¾ç¤ºç¬¬ä¸€ä¸ªé—®é¢˜
         */
        function startTest() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('test-content').classList.remove('hidden');
            displayQuestion(currentQuestionIndex);
        }

        /**
         * æ¸²æŸ“å½“å‰ç´¢å¼•çš„é—®é¢˜åˆ°ç•Œé¢
         * @param {number} index - å½“å‰é—®é¢˜åœ¨ QUESTIONS æ•°ç»„ä¸­çš„ç´¢å¼•
         */
        function displayQuestion(index) {
            const container = document.getElementById('question-container');
            const q = QUESTIONS[index];
            const questionNumber = index + 1;
            const totalQuestions = QUESTIONS.length;
            const fieldName = `q${q.id}`;
            const isLastQuestion = index === totalQuestions - 1;
            const isFirstQuestion = index === 0;

            // 1. æ›´æ–°æŒ‰é’®æ–‡æœ¬å’Œå¯è§æ€§
            const nextButton = document.getElementById('next-button');
            const prevButton = document.getElementById('prev-button');
            
            nextButton.textContent = isLastQuestion ? 'æäº¤ç­”æ¡ˆå¹¶æŸ¥çœ‹æŠ¥å‘Š' : 'ä¸‹ä¸€é¢˜';

            // æ§åˆ¶ä¸Šä¸€é¢˜æŒ‰é’®çš„å¯è§æ€§
            if (isFirstQuestion) {
                prevButton.classList.add('hidden');
                // è®©ä¸‹ä¸€é¢˜æŒ‰é’®ç‹¬å å®½åº¦
                nextButton.classList.remove('flex-grow');
                nextButton.classList.add('w-full');
            } else {
                prevButton.classList.remove('hidden');
                // æ¢å¤ flex å¸ƒå±€ä¸‹çš„å®½åº¦ç®¡ç†
                nextButton.classList.remove('w-full');
                nextButton.classList.add('flex-grow');
            }

            // 2. æ›´æ–°è¿›åº¦æ¡
            const progress = ((index + 1) / totalQuestions) * 100;
            document.getElementById('progress-indicator').style.width = `${progress}%`;

            // 3. æ¸²æŸ“å•ä¸ªé—®é¢˜
            let html = `
                <div class="p-6 bg-white border border-gray-200 rounded-xl shadow-lg transition duration-300">
                    <p class="text-2xl font-semibold mb-4 text-gray-800">
                        <span class="text-blue-600 font-bold">${questionNumber}/${totalQuestions}.</span> ${q.text}
                    </p>
                    <div class="flex flex-col sm:flex-row justify-between space-y-3 sm:space-y-0 sm:space-x-3 text-sm text-center mt-6">
                        
                        <!-- é€‰é¡¹ï¼š1åˆ† (éå¸¸ä¸åŒæ„) -->
                        <label class="radio-label flex-1">
                            <input type="radio" name="${fieldName}" value="1" required>
                            <div class="radio-tile p-3 rounded-lg bg-red-50 text-red-700 hover:bg-red-100">
                                <span class="font-medium">1 - éå¸¸ä¸åŒæ„</span>
                            </div>
                        </label>

                        <!-- é€‰é¡¹ï¼š2åˆ† (ä¸åŒæ„) -->
                        <label class="radio-label flex-1">
                            <input type="radio" name="${fieldName}" value="2" required>
                            <div class="radio-tile p-3 rounded-lg bg-yellow-50 text-yellow-700 hover:bg-yellow-100">
                                <span class="font-medium">2 - ä¸åŒæ„</span>
                            </div>
                        </label>

                        <!-- é€‰é¡¹ï¼š3åˆ† (ä¸­ç«‹/ä¸å¥½è¯´) -->
                        <label class="radio-label flex-1">
                            <input type="radio" name="${fieldName}" value="3" required>
                            <div class="radio-tile p-3 rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200">
                                <span class="font-medium">3 - ä¸­ç«‹</span>
                            </div>
                        </label>
                        
                        <!-- é€‰é¡¹ï¼š4åˆ† (åŒæ„) -->
                        <label class="radio-label flex-1">
                            <input type="radio" name="${fieldName}" value="4" required>
                            <div class="radio-tile p-3 rounded-lg bg-green-50 text-green-700 hover:bg-green-100">
                                <span class="font-medium">4 - åŒæ„</span>
                            </div>
                        </label>

                        <!-- é€‰é¡¹ï¼š5åˆ† (éå¸¸åŒæ„) -->
                        <label class="radio-label flex-1">
                            <input type="radio" name="${fieldName}" value="5" required>
                            <div class="radio-tile p-3 rounded-lg bg-blue-50 text-blue-700 hover:bg-blue-100">
                                <span class="font-medium">5 - éå¸¸åŒæ„</span>
                            </div>
                        </label>
                    </div>
                </div>
            `;
            container.innerHTML = html;

            // å¦‚æœç”¨æˆ·ä¹‹å‰å›ç­”è¿‡ï¼Œåˆ™é‡æ–°é€‰ä¸­ç­”æ¡ˆ
            const storedAnswer = userAnswers[q.id];
            if (storedAnswer) {
                const checkedRadio = document.querySelector(`input[name="${fieldName}"][value="${storedAnswer}"]`);
                if (checkedRadio) {
                    checkedRadio.checked = true;
                }
            }
        }
        
        /**
         * å¤„ç†è¿”å›ä¸Šä¸€é¢˜
         */
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion(currentQuestionIndex);
                document.getElementById('main-container').scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        /**
         * å¤„ç†ä¸‹ä¸€é¢˜æˆ–æäº¤ç­”æ¡ˆ
         */
        function nextQuestion() {
            const q = QUESTIONS[currentQuestionIndex];
            const fieldName = `q${q.id}`;
            // ç¡®ä¿æˆ‘ä»¬ä»å½“å‰æ¸²æŸ“çš„é—®é¢˜å®¹å™¨ä¸­è·å–é€‰å®šçš„ç­”æ¡ˆ
            const selected = document.querySelector(`#question-container input[name="${fieldName}"]:checked`);
            const errorMsg = document.getElementById('error-message');

            if (!selected) {
                errorMsg.textContent = `è¯·é€‰æ‹©æ‚¨çš„ç­”æ¡ˆåå†ç»§ç»­ã€‚`;
                errorMsg.classList.remove('hidden');
                return;
            }

            errorMsg.classList.add('hidden');
            
            // 1. å­˜å‚¨ç­”æ¡ˆ
            userAnswers[q.id] = parseInt(selected.value);

            // 2. æ£€æŸ¥æ˜¯å¦å®Œæˆ
            if (currentQuestionIndex < QUESTIONS.length - 1) {
                // æœªå®Œæˆï¼šåˆ‡æ¢åˆ°ä¸‹ä¸€é¢˜
                currentQuestionIndex++;
                displayQuestion(currentQuestionIndex);
                // æ»šåŠ¨åˆ°é¡¶éƒ¨ä»¥ç¡®ä¿ç”¨æˆ·çœ‹åˆ°æ–°é—®é¢˜
                document.getElementById('main-container').scrollIntoView({ behavior: 'smooth', block: 'start' });
            } else {
                // å·²å®Œæˆï¼šæ˜¾ç¤ºä»˜è´¹å¢™ (åªåœ¨æœ€åä¸€é¢˜æäº¤åå‡ºç°)
                showPaymentOverlay();
            }
        }

        /**
         * æ˜¾ç¤ºä»˜è´¹å¢™è¦†ç›–å±‚
         */
        function showPaymentOverlay() {
             // ç¡®ä¿åœ¨æ˜¾ç¤ºä»˜è´¹å¢™æ—¶ï¼Œæµ‹è¯•å†…å®¹åŒºåŸŸè¢«éšè—
             document.getElementById('main-container').classList.add('hidden');
             document.getElementById('payment-overlay').classList.remove('hidden');
             document.getElementById('payment-overlay').classList.add('flex'); // ç¡®ä¿ flex å¸ƒå±€æ˜¾ç¤º
        }

        /**
         * æ¨¡æ‹Ÿå……å€¼æˆåŠŸå¹¶æ˜¾ç¤ºç»“æœ
         */
        function simulatePayment() {
            // æ¨¡æ‹Ÿæ”¯ä»˜è¿‡ç¨‹ä¸­çš„åŠ è½½çŠ¶æ€ (å¯é€‰)
            const paymentButton = document.querySelector('#payment-overlay button');
            paymentButton.textContent = "æ­£åœ¨å¤„ç†æ”¯ä»˜...";
            paymentButton.disabled = true;
            paymentButton.classList.remove('bg-green-500', 'hover:bg-green-600');
            paymentButton.classList.add('bg-gray-400', 'cursor-not-allowed');

            setTimeout(() => {
                // 1. éšè—ä»˜è´¹å¢™
                document.getElementById('payment-overlay').classList.add('hidden');
                document.getElementById('payment-overlay').classList.remove('flex');

                // 2. è®¡ç®—ç»“æœ
                const mbtiType = calculateResult();

                // 3. æ¸²æŸ“ç»“æœ
                displayResult(mbtiType);

                // 4. æ˜¾ç¤ºç»“æœåŒºåŸŸ
                document.getElementById('result-display').classList.remove('hidden');

                // æ»šåŠ¨åˆ°é¡¶éƒ¨ä»¥æ˜¾ç¤ºç»“æœ
                window.scrollTo({ top: 0, behavior: 'smooth' });

            }, 1500); // æ¨¡æ‹Ÿ 1.5 ç§’çš„æ”¯ä»˜å¤„ç†æ—¶é—´
        }

        /**
         * å®é™…è®¡ç®— MBTI ç»“æœçš„å‡½æ•°
         */
        function calculateResult() {
            const scores = { E: 0, S: 0, T: 0, J: 0 };
            const counts = { E: 0, S: 0, T: 0, J: 0 };
            
            // éå†æ‰€æœ‰é—®é¢˜ç­”æ¡ˆ
            QUESTIONS.forEach(q => {
                const value = userAnswers[q.id]; // ä»å­˜å‚¨çš„ç­”æ¡ˆä¸­è·å–åˆ†æ•° (1-5)
                
                if (value !== undefined) {
                    let scoreToAdd;
                    
                    // å¦‚æœé—®é¢˜æ˜¯åå‘è®¡åˆ†çš„ (å¦‚ I/N/F/P å€¾å‘çš„é—®é¢˜)
                    if (q.reverse) {
                        // 1->4, 2->3, 3->2, 4->1, 5->0ã€‚è¿™æ ·é«˜åˆ†(5)åè€Œç»™ E/S/T/J å€¾å‘çš„åˆ†æ•°æ›´ä½
                        scoreToAdd = 5 - value; 
                    } else {
                        // 1->0, 2->1, 3->2, 4->3, 5->4ã€‚å€¼è¶Šå¤§ï¼Œè¶Šå€¾å‘äºå­—æ¯å®šä¹‰ (E, S, T, J)
                        scoreToAdd = value - 1; 
                    }
                    
                    scores[q.category] += scoreToAdd; 
                    counts[q.category] = (counts[q.category] || 0) + 1; // ç»Ÿè®¡è¯¥ç»´åº¦æœ‰å¤šå°‘é¢˜
                }
            });

            // ç¡®å®šæ¯ä¸ªç»´åº¦çš„ç±»å‹
            let mbti = '';

            // E/I ç»´åº¦: E è¶Šé«˜ï¼ŒI è¶Šä½ã€‚åˆ¤æ–­æ€»å¾—åˆ† vs ä¸­ä½æ•°
            const totalEQuestions = QUESTIONS.filter(q => q.category === 'E').length;
            const thresholdE = totalEQuestions * 4 / 2; // æ€»åˆ† 48ï¼Œé˜ˆå€¼ 24
            mbti += scores['E'] >= thresholdE ? 'E' : 'I';

            // S/N ç»´åº¦: S è¶Šé«˜ï¼ŒN è¶Šä½
            const totalSQuestions = QUESTIONS.filter(q => q.category === 'S').length;
            const thresholdS = totalSQuestions * 4 / 2; // æ€»åˆ† 52ï¼Œé˜ˆå€¼ 26
            mbti += scores['S'] >= thresholdS ? 'S' : 'N';

            // T/F ç»´åº¦: T è¶Šé«˜ï¼ŒF è¶Šä½
            const totalTQuestions = QUESTIONS.filter(q => q.category === 'T').length;
            const thresholdT = totalTQuestions * 4 / 2; // æ€»åˆ† 52ï¼Œé˜ˆå€¼ 26
            mbti += scores['T'] >= thresholdT ? 'T' : 'F';

            // J/P ç»´åº¦: J è¶Šé«˜ï¼ŒP è¶Šä½
            const totalJQuestions = QUESTIONS.filter(q => q.category === 'J').length;
            const thresholdJ = totalJQuestions * 4 / 2; // æ€»åˆ† 48ï¼Œé˜ˆå€¼ 24
            mbti += scores['J'] >= thresholdJ ? 'J' : 'P';

            // é™„å¸¦è¯¦ç»†åˆ†æ•°ä¿¡æ¯
            return {
                type: mbti,
                rawScores: scores,
                maxScores: { E: totalEQuestions * 4, S: totalSQuestions * 4, T: totalTQuestions * 4, J: totalJQuestions * 4 },
                counts: counts
            };
        }

        /**
         * æ¸²æŸ“ç»“æœåˆ° UI
         */
        function displayResult(resultData) {
            const { type, rawScores, maxScores } = resultData;
            const resultInfo = MBTI_RESULTS[type] || { name: 'æœªçŸ¥ç±»å‹', description: 'æœªèƒ½æ‰¾åˆ°åŒ¹é…çš„ç±»å‹æè¿°ã€‚' };

            document.getElementById('mbti-type').textContent = `${type} - ${resultInfo.name}`;
            document.getElementById('mbti-description').textContent = resultInfo.description;

            const analysisContainer = document.getElementById('dimension-analysis');
            analysisContainer.innerHTML = '';

            const dimensions = [
                { category: 'E', opposite: 'I', name: 'å¤–å‘ vs å†…å‘ (E/I)', max: maxScores['E'] },
                { category: 'S', opposite: 'N', name: 'å®æ„Ÿ vs ç›´è§‰ (S/N)', max: maxScores['S'] },
                { category: 'T', opposite: 'F', name: 'æ€ç»´ vs æƒ…æ„Ÿ (T/F)', max: maxScores['T'] },
                { category: 'J', opposite: 'P', name: 'åˆ¤æ–­ vs çŸ¥è§‰ (J/P)', max: maxScores['J'] }
            ];

            dimensions.forEach(dim => {
                const score = rawScores[dim.category];
                // å€¾å‘ç™¾åˆ†æ¯”ï¼šåŸºäº E/S/T/J çš„å¾—åˆ†å æ»¡åˆ†çš„æ¯”ä¾‹
                const percentage = Math.round((score / dim.max) * 100); 
                
                const typeLetter = type.includes(dim.category) ? dim.category : dim.opposite;

                // è®¡ç®—æ˜¾ç¤ºç™¾åˆ†æ¯”å’Œé¢œè‰²
                let finalPct;
                let side1Label;
                let side2Label;

                // æœ€ç»ˆç™¾åˆ†æ¯” (å€¾å‘æ€§)
                if (typeLetter === dim.category) {
                    // å€¾å‘ E/S/T/J: E/S/T/J (percentage)% vs I/N/F/P (100-percentage)%
                    finalPct = percentage;
                    side1Label = dim.category;
                    side2Label = dim.opposite;
                } else {
                    // å€¾å‘ I/N/F/P: I/N/F/P (100-percentage)% vs E/S/T/J (percentage)%
                    finalPct = 100 - percentage;
                    side1Label = dim.opposite;
                    side2Label = dim.category;
                }
                
                // ä¿è¯å€¾å‘ç™¾åˆ†æ¯”ä¸å°äº 50%
                finalPct = Math.max(50, finalPct);
                const barWidth = `${finalPct}%`;
                const colorClass = (typeLetter === 'E' || typeLetter === 'S' || typeLetter === 'J') ? 'bg-blue-500' : 'bg-pink-500';
                
                analysisContainer.innerHTML += `
                    <div class="border p-4 rounded-lg bg-gray-50">
                        <p class="text-lg font-bold mb-2 text-gray-700">${dim.name}</p>
                        <div class="flex justify-between text-sm font-medium mb-1">
                            <span>${side1Label} (${finalPct}%)</span>
                            <span>${side2Label} (${100 - finalPct}%)</span>
                        </div>
                        <div class="relative w-full h-3 bg-gray-200 rounded-full">
                            <div class="absolute h-3 rounded-full ${colorClass}" style="width: ${barWidth};"></div>
                        </div>
                    </div>
                `;
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆåï¼Œæ— éœ€è‡ªåŠ¨æ¸²æŸ“é—®é¢˜ï¼Œåªéœ€å±•ç¤ºå¼€å§‹å±å¹•ã€‚
        // window.onload = renderQuestions; // æ—§å‡½æ•°å·²ç§»é™¤
    </script>
</body>
</html>